require 'mharris_ext'

def archive_branch(name)
  raise "bad branch" unless name.present?

  puts name
  ec "git tag archive/#{name} #{name}"
  ec "git branch -D #{name}"
end

task :aba do
  # %w(cs_work local_mixins multi_cli per_page readme readme2 remote_array sample_initializer upgrade)
  %w(doc_work2).each do |n|
    archive_branch n
  end
end

def current_branch
  line = `git status`.split("\n").first.strip
  raise line unless line =~ /^on branch (.+)$/i
  res = $1.strip
  raise res unless res.present?
  res
end

task :pushc do
  b = current_branch
  cmd = "git push origin #{b}:#{b}"
  puts cmd
  exec cmd
end

task :pullc do
  b = current_branch
  cmd = "git pull origin #{b}:#{b}"
  puts cmd
  exec cmd
end

task :doc do
  ec "ruby doc/docs.rb"
end